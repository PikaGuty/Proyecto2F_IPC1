<!DOCTYPE HTML>
<html>
  <head>
    <title>html2pdf Test - Template</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link href="css/bootstrap.css" rel="stylesheet" />
    <style>@import url(http://fonts.googleapis.com/css?family=Bree+Serif);
        body, h1, h2, h3, h4, h5, h6{
          font-family: 'Bree Serif', serif;
                    }
    </style>
    <style>@import url(http://fonts.googleapis.com/css?family=Bree+Serif);
      body, h1, h2, h3, h4, h5, h6{
        font-family: 'Bree Serif', serif;
                    }
  </style>
  </head>

  <body>
    <!-- Button to generate PDF. -->


    <!-- Div to capture. -->
    <div id="root">
      <div class="container" id="all">
      <div class="row">
            
    <div class="col-xs-6">
      <!--<h1><a href=" "><img alt="" src="image/logo.png" /></a></h1>-->
    </div>
    <div class="col-xs-6 text-right">
              <div class="panel panel-default">
              
              <div class="panel-body">
                <h4>FACTURA : 
                    <a href="#" id="fac">N&uacute;mero de FACTURA</a>
                    <script>
                        
                        var d = new Date().getTime();
                        var uuid = 'xxxxx4xxxyxxxxx'.replace(/[xy]/g, function (c) {
                            var r = (d + Math.random() * 16) % 16 | 0;
                            d = Math.floor(d / 16);
                            return (c == 'x' ? r : (r & 0x3 | 0x8)).toString(16);
                        });
                        document.getElementById('fac').innerHTML= uuid;
                    </script>
                     <script>
                        window.onload = function(){
                            var fecha = new Date(); //Fecha actual
                            var mes = fecha.getMonth()+1; //obteniendo mes
                            var dia = fecha.getDate(); //obteniendo dia
                            var ano = fecha.getFullYear(); //obteniendo a√±o
                            if(dia<10)
                                dia='0'+dia; //agrega cero si el menor de 10
                            if(mes<10)
                                mes='0'+mes //agrega cero si el menor de 10
                        
                            var mess=""
                            switch(mes) {
                                case "01":
                                    mess="Enero"
                                    break;
                                case "02":
                                    mess="Febrero"
                                    break;
                                case "03":
                                    mess="Marzo"
                                    break;
                                case "04":
                                    mess="Abril"
                                    break;
                                case "05":
                                    mess="Mayo"
                                    break;
                                case "06":
                                    mess="Junio"
                                    break;
                                case "07":
                                    mess="Julio"
                                    break;
                                case "08":
                                    mess="Agosto"
                                    break;
                                case "09":
                                    mess="Septiembre"
                                    break;
                                case "10":
                                    mess="Agosto"
                                    break;
                                case "11":
                                    mess="Noviembre"
                                    break;
                                case "12":
                                    mess="Diciembre"
                                    break;
                                default:
                            }
                            document.getElementById('fech').innerHTML= dia+" de "+mess+" de "+ano;
                        }
                    </script>
                </h4>
              </div>
            </div>
          </div>
 
      <hr />
 
      
        <h1 style="text-align: center;">FACTURA</h1> 
      
        <div class="row">
          <div class="col-xs-12">
            <div class="panel panel-default">
                <div class="panel-heading">
                  <h4>Guatemala, <a href="#" id="fech"></a></h4>
                </div>
            <div class="panel-body">
            
              
                <h4>Paciente :  
                  <a href="#" id="cliente"></a></h4>
                <script>
                    var datos = sessionStorage.hhh
                    var dat=datos.split(",")

                    fetch(`http://54.214.118.211:3000/Personas/${dat[0]}`, {
                    method: 'GET',
                    headers:{
                        'Content-Type': 'application/json',
                        'Access-Control-Allow-Origin': '*',}})
                    .then(res => res.json())
                    .catch(err => {
                        console.error('Error:', err)
                        alert("Ocurrio un error, ver la consola")
                    })
                    .then(response =>{
                        console.log(response)
                        document.getElementById('cliente').innerHTML= response.Nombre+" "+response.Apellido;
                    })
                    
                    
                </script>
          
            </div>
            </div>
          </div>
          
        </div>
<pre></pre>
<table class="table table-bordered">
  <thead >
    <tr >
      <th style="text-align: center;">
        <h4>Cantidad</h4>
      </th>
      <th style="text-align: center;">
        <h4>Medicamento</h4>
      </th>
      <th style="text-align: center;">
        <h4>Total</h4>
      </th>
      
    </tr>
  </thead>
  <tbody id="des">
    
    <!--<tr >
      <td colspan="2" style="text-align: right;">Total</td>
      <td style="text-align: right;"><a href="#" id="tota"> 28500 </a></td>
    </tr>-->
  
  </tbody>
</table>
<pre></pre>
    

  <div class="row">
    <div class="panel panel-info"  >
      <h6> "LA ALTERACI&Oacute;N, FALSIFICACI&Oacute;N O COMERCIALIZACI&Oacute;N ILEGAL DE ESTE DOCUMENTO ESTA PENADO POR LA LEY :v"</h6>
    </div>
      
    
  </div>
    
</div>
</div>
    </div>

    <!-- Include html2pdf bundle. -->
    <script src="html2pdf.bundle.js"></script>

    <script>
        var compra=``
        var tabla = document.querySelector('#des')
        for (let  i= 2; i < dat.length; i=i+3) {
            if (dat[i+1]>0) {
                compra+=`<tr><td style="text-align: center;">${dat[i+1]}</td>
                    <td><a href="#">${dat[i]}</a></td>
                    <td class=" text-right " id="pi">${dat[i+2]}</td></tr>`
                tabla.innerHTML = compra
            }
            
        }
        compra+=`<tr><td colspan="2" style="text-align: right;">Total</td>
                     <td style="text-align: right;"><a href="#" id="tota">${dat[1]} </a></td></tr>`
                tabla.innerHTML = compra
    </script>

    <script>
      var element = document.getElementById('root');
      html2pdf().from(element).set({
          margin: .4,
          filename: 'FacturaMedicamentos.pdf',
          html2canvas: { scale: 2 },
          jsPDF: {orientation: 'landscape', unit: 'in', format: 'legal', compressPDF: true}
        }).save();
        setTimeout(() => {
          console.log("1 Segundo esperado")
          window.location.href = "ComprarMedicina.html";
        }, 7000);
        
    </script>
  </body>
</html>